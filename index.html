<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Remote Raid Lobby</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<div id="site-header">
  <img id="site-logo" src="images/raid_beacon_logo1.png" alt="Raid Beacon Logo">
  <h1 id="site-title">Raid Beacon</h1>
</div>
  <button id="info-button" onclick="showInfo()">‚ÑπÔ∏è Info</button>
  <button id="dark-toggle">üåô Toggle Dark Mode</button>
  <h2 class="subtitle">Pok√©mon GO Remote Raid Board</h2>

  <div class="raid-form">
    <input id="trainer" placeholder="Trainer Name" />
    <input id="boss" placeholder="Raid Boss (e.g. Rayquaza)" />
    <input id="code" placeholder="Friend Code" />
    <select id="team">
      <option value="">Team</option>
      <option value="Mystic">Mystic</option>
      <option value="Valor">Valor</option>
      <option value="Instinct">Instinct</option>
    </select>
    <button onclick="submitRaid()">Post Raid</button>
  </div>

  <div class="filters">
    <input type="text" id="search-boss" placeholder="Search by Boss Name">
    <select id="filter-team">
      <option value="">All Teams</option>
      <option value="Mystic">Mystic</option>
      <option value="Valor">Valor</option>
      <option value="Instinct">Instinct</option>
    </select>
  </div>

  <div class="tier-tabs">
    <button onclick="filterByTier('all')">All</button>
    <button onclick="filterByTier('1')">Tier 1</button>
    <button onclick="filterByTier('3')">Tier 3</button>
    <button onclick="filterByTier('4')">Tier 4</button>
    <button onclick="filterByTier('5')">Tier 5</button>
    <button onclick="filterByTier('6')">Tier 6</button>
    <button onclick="filterByTier('shadow')">Shadow</button>
    <button onclick="filterByTier('dynamax')">Dynamax</button>
    <button onclick="filterByTier('gigantamax')">Gigantamax</button>
  </div>

  <hr />
  <h2>Active Raids</h2>
  <div id="raid-list"></div>
  <hr />
  <h2>Community Chat</h2>
  <div class="chat-form">
    <input id="chat-name" placeholder="Your Name" />
    <input id="chat-message" placeholder="Type a message..." />
    <button onclick="postChat()">Send</button>
  </div>
  <div id="chat-messages"></div>

  <!-- Pok√©mon Data -->
  <script src="pokemonData.js"></script>
  <script src="script.js"></script>

  <!-- Firebase + Firestore -->
  <script type="module">
    // Firebase core
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
    import { 
      getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, orderBy 
    } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCks5cR37onDf2DUaNGZPQSTBkzgnS121g",
      authDomain: "pokemon-raids-ca7c4.firebaseapp.com",
      projectId: "pokemon-raids-ca7c4",
      storageBucket: "pokemon-raids-ca7c4.firebasestorage.app",
      messagingSenderId: "189905242015",
      appId: "1:189905242015:web:81256f098061fa1914dfaa"
    };

    // Initialize
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Submit raid ‚Üí Firestore
    window.submitRaid = async function () {
      const trainer = document.getElementById("trainer").value.trim();
      const boss = document.getElementById("boss").value.trim();
      const code = document.getElementById("code").value.trim();
      const team = document.getElementById("team").value;

      if (!trainer || !boss || !code) return alert("Fill all fields!");

      try {
        await addDoc(collection(db, "raids"), {
          trainer, boss, code, team,
          timestamp: serverTimestamp()
        });
        document.getElementById("trainer").value = "";
        document.getElementById("boss").value = "";
        document.getElementById("code").value = "";
        document.getElementById("team").value = "";
      } catch (e) {
        console.error("Error adding raid:", e);
      }
    };

    // Real-time raid updates
    const raidList = document.getElementById("raid-list");
    onSnapshot(
      query(collection(db, "raids"), orderBy("timestamp", "desc")),
      (snapshot) => {
        raidList.innerHTML = "";
        snapshot.forEach((doc) => {
          const raid = doc.data();
          const div = document.createElement("div");
          div.classList.add("raid-card");
          div.innerHTML = `
            <strong>${raid.boss}</strong><br/>
            Trainer: ${raid.trainer}<br/>
            Team: ${raid.team || "Unknown"}<br/>
            Code: ${raid.code}
          `;
          raidList.appendChild(div);
        });
      }
    );

    // Post chat message
    window.postChat = async function () {
      const name = document.getElementById("chat-name").value.trim();
      const message = document.getElementById("chat-message").value.trim();
      if (!name || !message) return;

      try {
        await addDoc(collection(db, "chat"), {
          name, message,
          timestamp: serverTimestamp()
        });
        document.getElementById("chat-message").value = "";
      } catch (e) {
        console.error("Error posting chat:", e);
      }
    };

    // Real-time chat updates
    const chatBox = document.getElementById("chat-messages");
    onSnapshot(
      query(collection(db, "chat"), orderBy("timestamp", "desc")),
      (snapshot) => {
        chatBox.innerHTML = "";
        snapshot.forEach((doc) => {
          const chat = doc.data();
          const div = document.createElement("div");
          div.classList.add("chat-message");
          div.innerHTML = `<strong>${chat.name}:</strong> ${chat.message}`;
          chatBox.appendChild(div);
        });
      }
    );

    // Dark mode toggle
    document.getElementById('dark-toggle').addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
    });
  </script>
</body>
</html>
